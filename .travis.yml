
services:
  - docker

language: minimal

env:
  global:
    - IMAGE_NAME=hepdata-converter 
    - IMAGE_NAME_REMOTE=hepdata/hepdata-converter
    - DOCKER_USERNAME=hepdata
    - secure: "MOD+ZHLoImmIeewZsbWuuWBKPq76S2ziW23qq5ZcFYkw/OmElxrhNoxr5wXXLodB/zFL6xAaBJSv9wIf/d+tSrvly+rLaDy6tpXOdhv97sxAHIVzXB65NPxoc2cpDleP2qyVcgUxPjtKyODLQW955D84wZMDW6vs3ihStUAB3/eJ9v1Zw0mdyLDTjxnvIdMPyYuKca319sCqh49zbGeBY92p3NRZxNn8FPlvIS8Nc1Z6HyrDGXzFQ4/Tiy1RfcUaoWOnWvhdQlhgq2FJzvJwFG2Av3GW7Xr94xFHPBxs+gvk7WGksgzUvPKoEv6ZG1cLNNZ2iGXTZgq5VnT5XSHe2axrp81m+rp0D4BPQcXE/jEBdYpQCMF1siys7oJP89SXRe8cIrsA2oKz3A0npNgWbfB0Z9W/WiXfZVnl7iVLdV9Ly63qqZ2q/i3VRQqVAoTUp9eFaEv8vIf5DMrrLj8E21nY7JHmQedxwggOzTIgGrTyQ/BdREjvIRzIsJhCfq6118/R/+fvl6SYk/PK+sAwXjf2s6zGhmlz9R0ljdrPKU6nFGUhlOe9c3dhk1PcXEfnBm95shUPkfka5w8NrMWNyP7UPpFvw4ECGFnB/BO6oii28uElnuNjuJXwdu2/XgneXePGQqCp7cvxs7vm7oZM3EfGSCNhm62o/B1DmpMVrX0="

cache:
  - docker

install:
  - echo 'creating hepdata-converter image...'

script:
  - "docker build -t $IMAGE_NAME ."

deploy:
  skip_cleanup: true
  provider: script
  script: bash docker_push
  on:
    repo: HEPData/hepdata-converter-docker
    all_branches: true
    condition: $TRAVIS_BRANCH == "master" || -n $TRAVIS_TAG
